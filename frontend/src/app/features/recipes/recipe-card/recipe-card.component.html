<div class="recipe-card">
  <div class="recipe-card-content">
    @if (isAuthenticated) {
      <button
        type="button"
        class="save-button"
        [class.saved]="recipe().isSaved"
        (click)="onToggleSave()"
        [title]="recipe().isSaved ? 'Unsave recipe' : 'Save recipe'"
      >
        @if (recipe().isSaved) {
          <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
            <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26" />
          </svg>
        } @else {
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
            <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26" />
          </svg>
        }
      </button>
    }
    @if (recipe().imageUrl) {
      <a [routerLink]="['/recipes', recipe().id, slugify(recipe().title)]" class="image-link">
        <img [src]="recipe().imageUrl" [alt]="recipe().title" class="recipe-image" />
      </a>
    }

    <div class="recipe-body">
      <div class="recipe-header">
        <a [routerLink]="['/recipes', recipe().id, slugify(recipe().title)]" class="recipe-title-link">
          <h3 class="recipe-title">{{ recipe().title }}</h3>
        </a>
        <div class="recipe-meta">
          <span class="category">{{ recipe().category }}</span>
          <span class="difficulty" [class]="'difficulty-' + recipe().difficulty">
            {{ recipe().difficulty }}
          </span>
        </div>
      </div>

      <p class="recipe-description">{{ recipe().description }}</p>

      <div class="recipe-footer">
        <div class="author-info">
          @if (recipe().author.avatarUrl) {
            <img
              [src]="recipe().author.avatarUrl"
              [alt]="recipe().author.username"
              class="author-avatar"
            />
          }
          <div class="author-details">
            <span class="author-name">{{ recipe().author.username }}</span>
            <span class="recipe-time">{{ recipe().createdAt | relativeTime }}</span>
          </div>
        </div>

        <div class="recipe-actions">
          <app-vote-buttons
            [recipeId]="recipe().id"
            [voteScore]="recipe().voteScore"
            [userVote]="recipe().userVote ?? null"
            (voteChange)="onVoteChange()"
          />
        </div>
      </div>
    </div>
  </div>
</div>
